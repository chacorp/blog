<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSH Times</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=UnifrakturMaguntia&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@200..900&display=swap" rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="script/threejs.js"></script>
    <script>hljs.highlightAll();</script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date();
            const date = today.getDate() + ". " + today.getMonth() + ". " + today.getFullYear();
            // const time =
            // today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();

            document.getElementById("main").innerHTML="Date: "+date;
            
            async function unloadJSONToBoxes() {
                // Remove all dynamically created content boxes
                const boxes = document.querySelectorAll('.postbox');
                boxes.forEach(box => {
                    if (!box.classList.contains('active')) {
                        box.remove();
                    }
                });

                const sidebar = document.querySelector('.sidebar');
                sidebar.innerHTML = ''; // Clear previous buttons to avoid duplication
            }
            
            async function loadJSONToBoxes(filePath, parent_id='') {
                try {
                    const response = await fetch(filePath);
                    if (!response.ok) {
                        throw new Error(`Failed to load JSON file: ${response.status}`);
                    }
                    const data = await response.json();
                    // console.log('Parsed JSON data:', data);
                    
                    const sidebar = document.querySelector('.sidebar');
                    sidebar.innerHTML = ''; // Clear previous buttons to avoid duplication

                    for (const [index, item] of data.entries()) {
                        // Create a new content box
                        const box = document.createElement('div');
                        box.id = `${parent_id}-post-box${index + 1}`;
                        box.className = 'content postbox';

                        // Load content from text file if specified
                        let textContent = '';
                        if (item.text.endsWith('.txt')) {
                            const textResponse = await fetch(item.text);
                            if (textResponse.ok) {
                                textContent = await textResponse.text();
                            } else {
                                console.error(`Failed to load text file: ${item.text}`);
                                textContent = 'Error loading content.';
                            }
                            textContent = `<p>${textContent}</p>`;
                        } else if (item.text.endsWith('.jpg') || item.text.endsWith('.png')) {
                            textContent = `<img src="${item.text}" class="postbox-image">`;
                        } else {
                            textContent = `<p>${item.text}</p>`;
                        }

                        box.innerHTML = `
                            <h2>${item.title}</h2>
                            ${textContent}
                        `;
                        document.body.appendChild(box);

                        // Add a button for the new box in the sidebar
                        const button = document.createElement('button');
                        button.textContent = item.title;
                        button.setAttribute('data-target', box.id);
                        sidebar.appendChild(button);

                        // Add event listener for the button
                        button.addEventListener('click', function() {
                            showContent(box.id);
                        });
                    }

                    // Trigger MathJax to render equations
                    MathJax.typeset();
                } catch (error) {
                    console.error('Error loading JSON file:', error);
                }
            }

            function showContent(id, keepSidebar = false) {
                const sections = document.querySelectorAll('.content');
                sections.forEach(section => section.classList.remove('active', 'sidebar-visible'));

                const targetSection = document.getElementById(id);
                if (targetSection) {
                    targetSection.classList.add('active');
                }

                // Handle sidebar visibility for Post-related sections
                const sidebar = document.querySelector('.sidebar');
                
                unloadJSONToBoxes()
                if ((id.includes('memo')) || (id.includes('work')) || (id.includes('poster'))) {
                    keyword=id.split('-')[0];
                    sidebar.classList.add('active');
                    loadJSONToBoxes(`data/${keyword}.json`, id);
                } 
                else {
                    sidebar.classList.remove('active');
                }
            }

            const navLinks = document.querySelectorAll('.navbar a');
            navLinks.forEach(link => {
                link.addEventListener('click', function(event) {
                    event.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    showContent(targetId);
                });
            });

            document.querySelector('.logo').addEventListener('click', () => {
                showContent('home');
            });
        });
    </script>
</head>

<body>
    <div class="navbar">
        
        <a id="main" class="logo" href="#"></a>
        <ul>
            <li><a href="#home">Home</a></li>
            <li><a href="#about">About</a></li>
            <li><a href="#work">Work</a></li>
            <li><a href="#poster">Poster</a></li>
            <li><a href="#memo">Memo</a></li>
            <li><a href="#cv">CV</a></li>
        </ul>
    
        <!-- <div class="sidebar-container active">
        </div> -->
        <div class="sidebar"></div>
    </div>
    

    <div id="home" class="content active">
        
        <div class="hline"></div>
        <div class="head boderline-double">
            <h1>The New Daily Post Times</h1>
            <!-- <p>The New Daily Post Times</p> -->
        </div>
        <div class="hline"></div>
        
        <div class="is-free">
            <!-- </br> -->
            <div class="text-container text_center">
                <p>WIP | Contents will be added soon | How you doin? | Quite well | Thank you very much  </p>
            </div>
            <div class="hline double no_margin"></div>
            <div class="base-container">
                <div class="two-column">
                    <div class="image-container is-300 text_center">
                        <img src="image/test.png" class="boderline-none">
                        <p>Fig.1 Image of a flash light.</p>
                        <!-- <img src="image/test.png" class="boderline-single"> -->
                    </div>
                    <div class="vline"></div>
                    <div class="text-container is-400">
                        <h1>Welcome to my blog!</h1>
                        <h2>Hello there!</h2>
                        <p>blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah</p>
                        <p>Still working in progress</p>
                        <abbr title="But nothing happened!">hold ur mouse here</abbr>
                    </div>
                </div>
            </div>
            <div class="hline"></div>

            <div class="base-container">
                <div class="two-column">
                    <div class="text-container is-400">
                        <p>blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah</p>
                    </div>
                    <div class="vline"></div>
                    <div class="text-container is-400">
                        <p>blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah</p>
                    </div>
                    <div class="vline"></div>
                    <div class="text-container is-400">
                        <p>blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah</p>
                    </div>
                    <div class="vline"></div>
                    <div class="text-container is-400">
                        <p>blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah</p>
                    </div>
                </div>
            </div>
            <div class="hline"></div>
            <!-- <div class="csharp">
                <pre>
                    <code class="language-csharp">
                        public void initialize(){
                
                        }
                    </code>
                </pre>
            </div> -->
            <div class="text-container noto-serif-kr">
                <hr>
                *1965년 생각들
                <blockquote> (전략) ⋯</blockquote>
                <blockquote>우리는 적어도 기술을 증오할 만큼 고도의 기술을 원한다 ⋯</blockquote>
                <blockquote>우리는 적어도 번영을 경시할 만큼 충분한 번영을 원한다.</blockquote>
                <blockquote>우리는 적어도 평화에 진력이 날 만큼 충분한 평화를 원한다.</blockquote>
                <blockquote> (후략) ⋯</blockquote>
                <hr>
            </div>
            <a class="noto-serif-kr"> - 백남준: 말에서 크리스토까지 에서 발췌,</a>
            <div class="text-container noto-serif-kr">
                <p>각주) *1965년 생각들: 1965년 6월 5일 부퍼탈 파르나스 갤러리에서 열린 해프닝, &lt; 24시간을 위한 원고 &gt; 독일 이체호에서 작성.</p>
            </div>

            <div class="hline"></div>
            <div class="base-container">
                <div class="two-column">
                    <div class="text-container is-200">
                        <h3>Rendering threejs</h3>
                        <h4><i>just for fun</i></h4>
                        <p>cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube cube</p>
                    </div>
                    <div class="vline"></div>
                    <div class="image-container is-400" id="canvas">
                        <script>rendering()</script>
                    </div>
                </div>
            </div>
            <div class="hline"></div>
        </div>
    </div>

    <div id="about" class="content is-800">
        <div class="hline"></div>
            <div class="base-container">

                <div class="two-column">
                    <div class="image-container text_center">
                        <img src="image/batman-thinking.gif" alt="Logo" class="logo-image">
                        <p>Gif.2 hmm...</p>
                    </div>
                    <div class="vline"></div>
                    <div class="text-container">
                        <h1>About</h1>
                        <p>This blog is about my personal scribbles.</p>
                        <p>It is about nothing and everything.</p>
                    </div>
                </div>
            </div>
        <div class="hline"></div>
        <hr>
        <div class="one-column">
            <h1>Who am I?</h1>
            <p></p>
            I wonder who I am...
        </div>
        <hr>
        <div class="hline"></div>
        <div class="base-container">
            <div class="two-column">
                <div class="text-container">
                    <p>Testing two column with image</p>
                </div>
                <div class="vline"></div>
                <div class="image-container text_center">
                    <img src="image/batman-thinking.gif" alt="Logo" class="logo-image">
                    <p>Gif.3 hmm...</p>
                </div>
            </div>
        </div>
        <div class="hline"></div>
    </div>

    <div id="memo" class="content is-800">
        <h1>Memo</h1>
        <p>This is the memo section.</p>
        <p>I post 뻘글 here.</p>
    </div>
    
    <div id="poster" class="content is-800">
        <h1>Poster</h1>
        <p>This is the Poster section.</p>
    </div>

    <div id="work" class="content is-800">
        <h1>Work</h1>
        <p>My works.</p>
    </div>

    <div id="cv" class="content is-800">
        <h1>My CV</h1>
        <p>Curriculum vitae a.k.a Resume</p>
        <p>career summary</p>
        <iframe src="https://chacorp.github.io/sihuncha/cv.html" title="CV Page"></iframe>
    </div>

</body>

</html>
